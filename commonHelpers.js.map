{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function fetchImages(query, currentPage) {\n  const API_KEY = '42031589-0742425241f8784341d5a922f';\n  const BASE_URL = 'https://pixabay.com';\n  const END_POINT = '/api/';\n  const url = `${BASE_URL}${END_POINT}`;\n\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15,\n    page: currentPage,\n  };\n\n  const res = await axios.get(url, { params });\n  return res.data;\n}\n","function imageTemplate({ largeImageURL, webformatURL, tags }) {\n  return `\n      <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img\n            class=\"gallery-image\"\n            src=\"${webformatURL}\"\n            data-source=\"${largeImageURL}\"\n            alt=\"${tags}\"\n          />\n        </a>\n      </li>\n      `;\n}\n\nexport function imagesTemplate(images) {\n  return images.map(imageTemplate).join('');\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { fetchImages } from './js/pixabay-api.js';\nimport { imagesTemplate } from './js/render-functions.js';\n\nlet gallery = null;\n\nconst refs = {\n  form: document.querySelector('.form'),\n  textInput: document.querySelector('#query'),\n  searchBtn: document.querySelector('.search-button'),\n  galleryList: document.querySelector('.gallery-list'),\n  searchLoader: document.querySelector('.search-loader'),\n  moreLoader: document.querySelector('.more-loader'),\n  moreBtn: document.querySelector('.more-button'),\n  moreWrapper: document.querySelector('.more-wrapper'),\n};\n\n//options for simplelightbox\nconst simplelightboxOptions = {\n  captions: true,\n  captionDelay: 250,\n  captionSelector: 'img',\n  captionType: 'attr',\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionClass: '',\n  captionHTML: true,\n  spinner: true,\n};\n\n// ======================================\nlet query;\nlet page;\nlet maxPage;\n\nrefs.form.addEventListener('submit', onFormSubmit);\nrefs.moreBtn.addEventListener('click', onLoadMoreClick);\n\n// ======================================\n\nasync function onFormSubmit(e) {\n  e.preventDefault();\n  query = e.target.elements.query.value.trim();\n  page = 1;\n\n  if (!query) {\n    showError('Empty field');\n    return;\n  }\n\n  showLoader();\n\n  try {\n    const data = await fetchImages(query, page);\n    if (data.total === 0) {\n      showError(\n        `Sorry, there are no images matching your search query. Please try again!`\n      );\n    }\n    maxPage = Math.ceil(data.total / 15);\n    refs.galleryList.innerHTML = '';\n    renderGallery(data.hits);\n\n    gallery = new SimpleLightbox('.gallery-list a', simplelightboxOptions);\n    gallery.refresh();\n  } catch (err) {\n    console.error(err);\n    showError(err);\n  }\n\n  hideLoader();\n  checkBtnVisibleStatus();\n  e.target.reset();\n}\n\nasync function onLoadMoreClick() {\n  page += 1;\n  showLoader();\n  const data = await fetchImages(query, page);\n  renderGallery(data.hits);\n  hideLoader();\n  checkBtnVisibleStatus();\n\n  gallery.destroy();\n  gallery = new SimpleLightbox('.gallery-list a', simplelightboxOptions);\n  gallery.refresh();\n\n  const height =\n    refs.galleryList.firstElementChild.getBoundingClientRect().height;\n\n  scrollBy({\n    behavior: 'smooth',\n    top: height * 2,\n  });\n}\n\n// ======================================\nfunction renderGallery(images) {\n  const markup = imagesTemplate(images);\n  refs.galleryList.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction showLoadBtn() {\n  refs.moreWrapper.classList.remove('hidden');\n}\nfunction hideLoadBtn() {\n  refs.moreWrapper.classList.add('hidden');\n}\n\nfunction showLoader() {\n  refs.searchLoader.classList.remove('hidden');\n}\nfunction hideLoader() {\n  refs.searchLoader.classList.add('hidden');\n}\n\nfunction showError(msg) {\n  iziToast.error({\n    message: msg,\n    position: 'topRight',\n  });\n}\n\nfunction checkBtnVisibleStatus() {\n  if (page >= maxPage) {\n    hideLoadBtn();\n  } else {\n    showLoadBtn();\n  }\n}\n// ========================================\n"],"names":["fetchImages","query","currentPage","API_KEY","url","params","axios","imageTemplate","largeImageURL","webformatURL","tags","imagesTemplate","images","gallery","refs","simplelightboxOptions","page","maxPage","onFormSubmit","onLoadMoreClick","e","showError","showLoader","data","renderGallery","SimpleLightbox","err","hideLoader","checkBtnVisibleStatus","height","markup","showLoadBtn","hideLoadBtn","msg","iziToast"],"mappings":"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"}