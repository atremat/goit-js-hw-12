{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\n\nlet page;\nlet searchText = '';\n\nconst refs = {\n  form: document.querySelector('.form'),\n  textInput: document.querySelector('#query'),\n  searchBtn: document.querySelector('.search-button'),\n  galleryList: document.querySelector('.gallery-list'),\n  searchLoader: document.querySelector('.search-loader'),\n  moreLoader: document.querySelector('.more-loader'),\n  moreBtn: document.querySelector('.more-button'),\n};\n\n//options for simplelightbox\nconst simplelightboxOptions = {\n  captions: true,\n  captionDelay: 250,\n  captionSelector: 'img',\n  captionType: 'attr',\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionClass: '',\n  captionHTML: true,\n};\n\nrefs.form.addEventListener('submit', onSearch);\n\nasync function onSearch(e) {\n  e.preventDefault();\n\n  //page = 1 by default\n  page = 1;\n  //show css-loader\n  loaderShow(refs.searchLoader);\n\n  //value of input\n  searchText = e.currentTarget.elements.query.value;\n\n  try {\n    const data = await fetchPhotos(searchText);\n    createGallery(data);\n  } catch (err) {\n    console.log(err);\n  }\n\n  //fetch photos\n  // axios\n  //   .get(`https://pixabay.com/api/?${searchParams}`)\n  //   .then(response => {\n  //     createGallery(response.data);\n  //   })\n  //   .catch(error => console.log(error))\n  //   .finally(() => {\n  //     refs.form.reset();\n  //   });\n}\nasync function fetchPhotos(searchText) {\n  //parameters of searching query\n  const searchParams = new URLSearchParams({\n    key: '42031589-0742425241f8784341d5a922f',\n    q: searchText,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15,\n    page,\n  });\n  const response = await axios.get(`https://pixabay.com/api/?${searchParams}`);\n  const data = response.data;\n  return data;\n}\n\nfunction renderGalleryMarkup(photoList) {\n  //creating markup\n  return photoList\n    .map(photo => {\n      return `\n      <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${photo.largeImageURL}\">\n          <img\n            class=\"gallery-image\"\n            src=\"${photo.webformatURL}\"\n            data-source=\"${photo.largeImageURL}\"\n            alt=\"${photo.tags}\"\n          />\n        </a>\n      </li>\n      `;\n    })\n    .join('\\n');\n}\n\nfunction loaderHide(loader) {\n  loader.classList.add('hidden');\n}\n\nfunction loaderShow(loader) {\n  loader.classList.remove('hidden');\n}\n\nfunction createGallery(data) {\n  //if images are not found, then alert\n  if (data.total === 0) {\n    iziToast.error({\n      message: `Sorry, there are no images matching your search query. Please try again!`,\n      position: 'topRight',\n    });\n\n    //clear gallery if images not found\n    refs.galleryList.innerHTML = '';\n\n    //hiding css-load\n    loaderHide(refs.searchLoader);\n    return;\n  }\n\n  //if images are found, then rendering gallery\n  refs.galleryList.innerHTML = renderGalleryMarkup(data.hits);\n\n  //hiding css-load\n  loaderHide(refs.searchLoader);\n\n  //initializing simplelightbox\n  const gallery = new SimpleLightbox('.gallery-list a', simplelightboxOptions);\n  gallery.refresh();\n}\n\nrefs.moreBtn.addEventListener('click', onMoreClick);\n\nasync function onMoreClick(e) {\n  //!loader show bottom\n  loaderShow(refs.moreLoader);\n  try {\n    page += 1;\n    const data = await fetchPhotos(searchText);\n    const markup = renderGalleryMarkup(data.hits);\n    loaderHide(refs.moreLoader);\n    refs.galleryList.insertAdjacentHTML('beforeend', markup);\n  } catch (err) {\n    loaderHide(refs.moreLoader);\n    console.log(err);\n  }\n}\n"],"names":["page","searchText","refs","simplelightboxOptions","onSearch","e","loaderShow","data","fetchPhotos","createGallery","err","searchParams","axios","renderGalleryMarkup","photoList","photo","loaderHide","loader","iziToast","SimpleLightbox","onMoreClick","markup"],"mappings":"owBAMA,IAAIA,EACAC,EAAa,GAEjB,MAAMC,EAAO,CACX,KAAM,SAAS,cAAc,OAAO,EACpC,UAAW,SAAS,cAAc,QAAQ,EAC1C,UAAW,SAAS,cAAc,gBAAgB,EAClD,YAAa,SAAS,cAAc,eAAe,EACnD,aAAc,SAAS,cAAc,gBAAgB,EACrD,WAAY,SAAS,cAAc,cAAc,EACjD,QAAS,SAAS,cAAc,cAAc,CAChD,EAGMC,EAAwB,CAC5B,SAAU,GACV,aAAc,IACd,gBAAiB,MACjB,YAAa,OACb,aAAc,MACd,gBAAiB,SACjB,aAAc,GACd,YAAa,EACf,EAEAD,EAAK,KAAK,iBAAiB,SAAUE,CAAQ,EAE7C,eAAeA,EAASC,EAAG,CACzBA,EAAE,eAAc,EAGhBL,EAAO,EAEPM,EAAWJ,EAAK,YAAY,EAG5BD,EAAaI,EAAE,cAAc,SAAS,MAAM,MAE5C,GAAI,CACF,MAAME,EAAO,MAAMC,EAAYP,CAAU,EACzCQ,EAAcF,CAAI,CACnB,OAAQG,EAAK,CACZ,QAAQ,IAAIA,CAAG,CAChB,CAYH,CACA,eAAeF,EAAYP,EAAY,CAErC,MAAMU,EAAe,IAAI,gBAAgB,CACvC,IAAK,qCACL,EAAGV,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAAD,CACJ,CAAG,EAGD,OAFiB,MAAMY,EAAM,IAAI,4BAA4BD,CAAY,EAAE,GACrD,IAExB,CAEA,SAASE,EAAoBC,EAAW,CAEtC,OAAOA,EACJ,IAAIC,GACI;AAAA;AAAA,wCAE2BA,EAAM,aAAa;AAAA;AAAA;AAAA,mBAGxCA,EAAM,YAAY;AAAA,2BACVA,EAAM,aAAa;AAAA,mBAC3BA,EAAM,IAAI;AAAA;AAAA;AAAA;AAAA,OAKxB,EACA,KAAK;AAAA,CAAI,CACd,CAEA,SAASC,EAAWC,EAAQ,CAC1BA,EAAO,UAAU,IAAI,QAAQ,CAC/B,CAEA,SAASX,EAAWW,EAAQ,CAC1BA,EAAO,UAAU,OAAO,QAAQ,CAClC,CAEA,SAASR,EAAcF,EAAM,CAE3B,GAAIA,EAAK,QAAU,EAAG,CACpBW,EAAS,MAAM,CACb,QAAS,2EACT,SAAU,UAChB,CAAK,EAGDhB,EAAK,YAAY,UAAY,GAG7Bc,EAAWd,EAAK,YAAY,EAC5B,MACD,CAGDA,EAAK,YAAY,UAAYW,EAAoBN,EAAK,IAAI,EAG1DS,EAAWd,EAAK,YAAY,EAGZ,IAAIiB,EAAe,kBAAmBhB,CAAqB,EACnE,QAAO,CACjB,CAEAD,EAAK,QAAQ,iBAAiB,QAASkB,CAAW,EAElD,eAAeA,EAAYf,EAAG,CAC9B;AACEC,EAAWJ,EAAK,UAAU,EAC1B,GAAI,CACFF,GAAQ,EACR,MAAMO,EAAO,MAAMC,EAAYP,CAAU,EACnCoB,EAASR,EAAoBN,EAAK,IAAI,EAC5CS,EAAWd,EAAK,UAAU,EAC1BA,EAAK,YAAY,mBAAmB,YAAamB,CAAM,CACxD,OAAQX,EAAK,CACZM,EAAWd,EAAK,UAAU,EAC1B,QAAQ,IAAIQ,CAAG,CAChB,CACH"}